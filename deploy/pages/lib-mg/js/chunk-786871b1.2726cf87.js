(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-786871b1"],{"32a7":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table",staticStyle:{height:"100%"}},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 角色管理\n      ")])],1)],1),a("div",{staticClass:"container",staticStyle:{"min-height":"100%"}},[a("div",{staticClass:"handle-box"},[a("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"角色名称"},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name",t)},expression:"query.name"}}),a("el-button",{attrs:{type:"primary",icon:"search"},on:{click:e.search}},[e._v("搜索")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.permissions.add,expression:"permissions.add"}],attrs:{type:"primary",icon:"add"},on:{click:e.handleAdd}},[e._v("新增")])],1),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData.results,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),a("el-table-column",{attrs:{prop:"name",label:"角色名称",width:"120"}}),a("el-table-column",{attrs:{prop:"remarks",label:"说明"}}),a("el-table-column",{attrs:{prop:"createDate",label:"创建时间",width:"160",formatter:e.formatter}}),a("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"!=t.row.isSys?a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.permissions.menu,expression:"permissions.menu"}],attrs:{type:"text",icon:"el-icon-setting"},on:{click:function(a){return e.handlePer(t.$index,t.row)}}},[e._v("权限")]):e._e(),"1"!=t.row.isSys?a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.permissions.edit,expression:"permissions.edit"}],attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]):e._e(),"1"!=t.row.isSys?a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.permissions.del,expression:"permissions.del"}],staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")]):e._e()]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.tableData.page,layout:"prev, pager, next",total:e.tableData.total},on:{"current-change":e.handleCurrentChange}})],1)],1),a("el-dialog",{attrs:{title:e.form.title,visible:e.editVisible,width:"40%"},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"角色名称",prop:"remarks"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),a("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"提示",visible:e.delVisible,width:"300px",center:""},on:{"update:visible":function(t){e.delVisible=t}}},[a("div",{staticClass:"del-dialog-cnt"},[e._v("删除不可恢复，是否确定删除？")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.delVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.deleteRow}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{id:"permissions","close-on-click-modal":!1,title:e.form.title,visible:e.perVisible,width:"40%"},on:{"update:visible":function(t){e.perVisible=t}}},[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.loading2,expression:"loading2"}],ref:"tree",attrs:{data:e.menuTree,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":e.myMenu,props:e.defaultProps}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.loading2,expression:"!loading2"}],on:{click:function(t){e.perVisible=!1}}},[e._v("取 消")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.loading2,expression:"!loading2"}],attrs:{type:"primary"},on:{click:e.addRoleMenu}},[e._v("保存")])],1)],1)],1)},r=[],o=(a("7f7f"),a("57e7"),a("ac6a"),a("f3e2"),a("e8b6")),n=a("5a30"),i={name:"basetable",data:function(){return{loading:null,loading2:!0,tableData:{total:0,page:1,results:[]},cur_page:1,multipleSelection:[],select_word:"",del_list:[],is_search:!1,editVisible:!1,delVisible:!1,perVisible:!1,permissions:{del:n["a"].permCheck("role:del"),edit:n["a"].permCheck("role:edit"),add:n["a"].permCheck("role:add"),menu:n["a"].permCheck("role:menu")},query:{phone:"",user_name:""},fullscreenLoading:!1,stateMap:{1:"有效",0:"无效"},form:{name:"",remarks:""},idx:-1,rules:{name:[{required:!0,message:"角色名称",trigger:"blur"}]},menuTree:[],myMenu:[],defaultProps:{children:"children",label:"label"}}},created:function(){this.getData()},computed:{data:function(){return this.tableData}},methods:{showLoading:function(){this.loading=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})},handleCurrentChange:function(e){this.tableData.page=e,this.getData()},getData:function(){var e=this;e.showLoading(),o["a"].pageList("/system/role/pageList",e.tableData.page,10,e.query,(function(t){e.loading&&e.loading.close(),e.tableData=t}))},search:function(){this.is_search=!0,this.handleCurrentChange(1)},formatter:function(e,t){return n["a"].formatter(e.createDate,"yyyy-MM-dd hh:mm:ss")},statusFormatter:function(e,t){return this.stateMap[e.status]},filterTag:function(e,t){return t.tag===e},initMyMenu:function(e,t){if(null!=e&&0!=e.length&&null!=t&&0!=t.length){var a=this;e.forEach((function(e){(null==e.children||0==e.children.length)&&t.indexOf(e.id)>-1?a.myMenu.push(e.id):a.initMyMenu(e.children,t)}))}},handlePer:function(e,t){var a=this;a.loading2=!0,a.menuTree=[],a.myMenu=[],this.perVisible=!0,this.idx=e,o["a"].post("/system/menu/roleMenuAndAllMenu",{roleId:t.id},(function(e){a.loading2=!1,o["a"].isOK(e)?(a.menuTree=e.body.menuTree,a.initMyMenu(a.menuTree,e.body.myMenu)):a.$message.error(o["a"].getMsg(e))}))},handleAdd:function(){this.form={title:"新增",status:"1"},this.$refs["form"]&&this.$refs["form"].clearValidate(),this.editVisible=!0},handleEdit:function(e,t){this.idx=e,this.form={id:t.id,remarks:t.remarks,name:t.name,title:"编辑"},this.$refs["form"]&&this.$refs["form"].clearValidate(),this.editVisible=!0},handleDelete:function(e,t){this.idx=e,this.delVisible=!0},handleSelectionChange:function(e){this.multipleSelection=e},saveEdit:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return loading.close(),!1;e.showLoading(),o["a"].post("/system/role/saveOrUpdate",e.form,(function(t){e.loading&&e.loading.close(),o["a"].isOK(t)?(e.handleCurrentChange(1),e.editVisible=!1,e.$message.success("操作成功")):e.$message.error(o["a"].getMsg(t))}))}))},deleteRow:function(){var e=this,t=this.tableData.results[this.idx];e.showLoading(),o["a"].post("/system/role/del",{id:t.id},(function(t){e.loading&&e.loading.close(),o["a"].isOK(t)?(e.handleCurrentChange(1),e.$message.success("删除成功")):e.$message.error(o["a"].getMsg(t)),e.delVisible=!1}))},addRoleMenu:function(){var e=this,t=this.$refs.tree.getHalfCheckedKeys(),a=this.$refs.tree.getCheckedKeys(),s=new Array;s=n["a"].concat(s,t),s=n["a"].concat(s,a);var r=this.tableData.results[this.idx];e.showLoading(),o["a"].post("/system/menu/addRoleMenu",{roleId:r.id,ids:s},(function(t){e.loading&&e.loading.close(),o["a"].isOK(t)?(e.perVisible=!1,e.$message.success("操作成功")):e.$message.error(o["a"].getMsg(t)),e.delVisible=!1}))}}},l=i,d=(a("6151"),a("2877")),c=Object(d["a"])(l,s,r,!1,null,"76ee4448",null);t["default"]=c.exports},6151:function(e,t,a){"use strict";var s=a("ad78"),r=a.n(s);r.a},ad78:function(e,t,a){},e8b6:function(e,t,a){"use strict";var s=a("bc3a"),r=a.n(s);a("5a30");r.a.defaults.timeout=6e4,r.a.interceptors.request.use((function(e){return e.headers["X-Requested-With"]="XMLHttpRequest","post"===e.method?void 0!=e.data&&(e.headers["Content-type"]="application/json;charset=UTF-8",e.data=JSON.stringify(e.data)):e.params=e.data,e}),(function(e){return Promise.reject(e)})),r.a.defaults.retry=1,r.a.defaults.retryDelay=1e3,r.a.interceptors.response.use((function(e){return e}),(function(e){var t=e.config;if(!t||!t.retry)return Promise.reject(e);if(t.__retryCount=t.__retryCount||0,t.__retryCount>=t.retry)return Promise.reject(e);t.__retryCount+=1;var a=new Promise((function(e){setTimeout((function(){e()}),t.retryDelay||1)}));return a.then((function(){return r()(t)}))}));var o=r.a,n=a("a18c"),i=a("2b0e"),l=function(e,t,a,s,r,o){var n={sort:{}};n.page=t,n.size=a,n.fromData=s,d(e,n,r,o)},d=function(e,t,a,s){o.post("/lib-server/mg"+e,t).then((function(e){a(e.data)})).catch((function(e){if(e&&e.response)switch(e.response.status){case 400:e.message="请求错误(400)",i["default"].prototype.$message.error("请求错误(400)");break;case 401:e.message="未授权，请重新登录(401)",i["default"].prototype.$message.error("未授权，请重新登录(401)");break;case 403:e.message="拒绝访问(403)",i["default"].prototype.$message.error("请求出错(404)");break;case 404:e.message="请求出错(404)",i["default"].prototype.$message.error("请求出错(404)");break;case 408:e.message="请求超时(408)",i["default"].prototype.$message.error("请求超时(408))");break;case 500:e.message="服务器错误(500)",i["default"].prototype.$message.error("服务器错误(500)");break;case 501:e.message="服务未实现(501)",i["default"].prototype.$message.error("服务未实现(501)");break;case 502:e.message="网络错误(502)",i["default"].prototype.$message.error("网络错误(502)");break;case 503:e.message="服务不可用(503)",i["default"].prototype.$message.error("服务不可用(503)");break;case 504:e.message="网络超时(504)",i["default"].prototype.$message.error("网络超时(504)");break;case 1e3:sessionStorage.removeItem("loginInfo"),n["a"].push("/login");break;case 1403:n["a"].push("/403");break;default:e.message="连接出错(".concat(e.response.status,")!")}else e.message="连接服务器失败!",i["default"].prototype.$message.error("连接服务器失败!");s&&s(e),i["default"].prototype.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}).close()}))},c=function(e,t,a){var s="文件下载.xlsx";o.post("/lib-server/mg"+e,t,{responseType:"blob"}).then((function(e){null!=e.headers.filename&&"undefined"!=e.headers.filename&&(s=e.headers.filename);var t=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8"}),a=document.createElement("a"),r=window.URL.createObjectURL(t);a.href=r,a.download=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(r)})).catch((function(e){if(e&&e.response)switch(e.response.status){case 400:e.message="请求错误(400)",i["default"].prototype.$message.error("请求错误(400)");break;case 401:e.message="未授权，请重新登录(401)",i["default"].prototype.$message.error("未授权，请重新登录(401)");break;case 403:e.message="拒绝访问(403)",i["default"].prototype.$message.error("请求出错(404)");break;case 404:e.message="请求出错(404)",i["default"].prototype.$message.error("请求出错(404)");break;case 408:e.message="请求超时(408)",i["default"].prototype.$message.error("请求超时(408))");break;case 500:e.message="服务器错误(500)",i["default"].prototype.$message.error("服务器错误(500)");break;case 501:e.message="服务未实现(501)",i["default"].prototype.$message.error("服务未实现(501)");break;case 502:e.message="网络错误(502)",i["default"].prototype.$message.error("网络错误(502)");break;case 503:e.message="服务不可用(503)",i["default"].prototype.$message.error("服务不可用(503)");break;case 504:e.message="网络超时(504)",i["default"].prototype.$message.error("网络超时(504)");break;case 1e3:sessionStorage.removeItem("loginInfo"),n["a"].push("/login");break;case 1403:n["a"].push("/403");break;default:e.message="连接出错(".concat(e.response.status,")!")}else e.message="连接服务器失败!",i["default"].prototype.$message.error("连接服务器失败!");a&&a(e),i["default"].prototype.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}).close()}))},u=function(e){return"0"==e.state},m=function(e){return e.body},p=function(e){return e.msg};t["a"]={post:d,isOK:u,getBody:m,getMsg:p,pageList:l,expExcel:c}}}]);